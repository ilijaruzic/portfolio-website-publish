import{u as e,c as t,r,j as n}from"./vendor-react-HKm_9Y_d.js";import{r as o}from"./index-Bxasvqa-.js";import{F as a}from"./vendor-other-BbrUZ2Se.js";const s=e=>"string"==typeof e?e:Array.isArray(e)?e.map(s).join(" "):"object"==typeof e&&null!==e?Object.values(e).map(s).join(" "):"";function i({className:i="",minQueryLength:l=3}){const{t:d,i18n:c}=e(),u=t(),[g,x]=r.useState(""),[m,p]=r.useState(""),[h,f]=r.useState([]),[b,w]=r.useState(null),[k,y]=r.useState(-1),[v,j]=r.useState("none"),[N,L]=r.useState(!1),E=r.useRef(null),C=r.useRef(null),$=()=>{if(C.current){const e=C.current.getBoundingClientRect(),t=document.querySelector(".Footer");let r;if(t){const e=t.getBoundingClientRect();r=e.top>window.innerHeight?window.innerHeight:e.top}else r=window.innerHeight;const n=r-e.bottom-20;j(`${Math.max(n,150)}px`)}};r.useLayoutEffect(()=>{$();const e=new ResizeObserver($);return e.observe(document.body),window.addEventListener("scroll",$),window.addEventListener("resize",$),()=>{e.disconnect(),window.removeEventListener("scroll",$),window.removeEventListener("resize",$)}},[h,N]),r.useEffect(()=>{clearTimeout(window.debounceTimeout),window.debounceTimeout=setTimeout(()=>{p(g.trim().toLowerCase())},300)},[g]),r.useEffect(()=>{const e=c.getResourceBundle(c.language,"translation");if(e){const t=((e,t,r,n)=>{const o=t.language||"en",i=e,l=window.location.origin,d="en"===o?"":`/${o}`,c=[];r.forEach(e=>{const t=(r=i,e.key.split(".").reduce((e,t)=>e&&e[t],r));var r;if(!t)return;const o=`${d}/${"/"===e.path?"":e.path}`.replace(/\/+/g,"/"),a=`${l}${o}`.replace(/\/$/,""),u=o.split("/").filter(Boolean).length,g=(e,t=null)=>{if("object"!=typeof e||null===e)return;const r=e.title||e.name||e.heading||e.role,n=(e=>{const t=["subtitle","content","par1","par2","role","degree"];let r="";for(const o of t)if(e[o]){const t=e[o];r="object"==typeof t?Object.values(t).join(" "):t;break}if(!r)return"";const n=r.match(/[^.!?]+[.!?]/);return n?n[0].trim():r.trim()})(e),i=Object.values(e).some(e=>"object"==typeof e&&null!==e&&(e.title||e.name||e.heading||e.role));r&&"string"==typeof r&&!i&&c.push({url:a,navigateUrl:o,title:r,context:t,snippet:n,fullText:s(e),depth:u}),Object.values(e).forEach(e=>{"object"==typeof e&&null!==e&&g(e,r||t)})},x=e.key.split(".").pop(),m=t.title||n(`header.${x}`)||x;g(t,m)});const u=c.filter((e,t,r)=>t===r.findIndex(t=>t.title.toLowerCase()===e.title.toLowerCase()&&t.navigateUrl===e.navigateUrl));return new a(u,{includeScore:!0,threshold:.2,ignoreLocation:!0,keys:[{name:"title",weight:15},{name:"fullText",weight:1}]})})(e,c,o,d);w(t)}},[c.language,d]),r.useEffect(()=>{if(!m||!b||m.length<l)return f([]),void L(!1);L(!0);const e=setTimeout(()=>{const e=((e,t)=>e.search(t).map(e=>{const t=.15*e.item.depth;return{...e,score:e.score-t}}).sort((e,t)=>e.score-t.score).slice(0,10).map(({item:e})=>({title:e.context&&!e.context.includes(".")&&e.title.toLowerCase()!==e.context.toLowerCase()?`${e.context} â€º ${e.title}`:e.title,url:e.url,navigateUrl:e.navigateUrl,snippet:e.snippet})))(b,m);f(e),y(e.length?0:-1),L(!1)},600);return()=>clearTimeout(e)},[m,b,l]);const S=()=>{x(""),p(""),f([]),y(-1),L(!1),C.current&&C.current.focus()},M=e=>{x(""),f([]),u(e)},T=!N&&m.length>=l&&0===h.length,U=m.length>=l;return n.jsxs("div",{ref:E,className:`relative w-full ${i}`,children:[n.jsxs("div",{className:"relative z-[60]",children:[n.jsx("input",{ref:C,type:"text",placeholder:d("search.placeholder"),className:"peer w-full pl-9 sm:pl-11 pr-10 py-2 sm:py-3 rounded-lg border-2 border-gray-400 bg-white dark:bg-black dark:text-white dark:border-gray-500 outline-none focus:border-indigo-500 dark:focus:border-indigo-200 text-sm sm:text-base transition-all",value:g,onChange:e=>x(e.target.value),onKeyDown:e=>{"ArrowDown"===e.key?(e.preventDefault(),y(e=>Math.min(e+1,h.length-1))):"ArrowUp"===e.key?(e.preventDefault(),y(e=>Math.max(e-1,0))):"Enter"===e.key&&k>=0?M(h[k].navigateUrl):"Escape"===e.key&&S()}}),n.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 sm:w-5 sm:h-5 pointer-events-none transition-colors text-gray-500 dark:text-gray-400 peer-focus:text-indigo-500 dark:peer-focus:text-indigo-200",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-4.35-4.35M17 11a6 6 0 11-12 0 6 6 0 0112 0z"})}),g&&n.jsx("button",{onClick:S,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-200 transition-colors p-1",children:n.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),U&&n.jsx("ul",{style:{maxHeight:v},className:"absolute left-0 right-0 z-50 mt-2 bg-white dark:bg-black border-2 border-gray-200 dark:border-indigo-200 rounded-lg shadow-none dark:shadow-sm dark:shadow-indigo-200 overflow-y-auto overscroll-contain",children:N?n.jsxs("li",{className:"p-3 sm:p-4 text-center text-indigo-500 dark:text-indigo-200 text-xs sm:text-base flex items-center justify-center gap-2",children:[n.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-500 dark:bg-indigo-200 rounded-full animate-bounce [animation-delay:-0.3s]"}),n.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-500 dark:bg-indigo-200 rounded-full animate-bounce [animation-delay:-0.15s]"}),n.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-500 dark:bg-indigo-200 rounded-full animate-bounce"}),d("search.in-progress")]}):T?n.jsx("li",{className:"p-3 sm:p-4 text-center text-gray-500 dark:text-gray-400 text-xs sm:text-base",children:d("search.no-results")}):h.map((e,t)=>n.jsx("li",{onMouseEnter:()=>y(t),className:"flex",children:n.jsxs("button",{onClick:()=>M(e.navigateUrl),className:"w-full text-left p-3 sm:p-4 border-b last:border-0 border-gray-100 dark:border-indigo-200/20 flex flex-col h-auto transition-colors "+(t===k?"bg-indigo-500 text-white dark:bg-indigo-200 dark:text-black":""),children:[n.jsx("div",{className:"font-bold leading-tight break-words mb-1 text-xs sm:text-base "+(t===k?"text-white dark:text-black":"text-black dark:text-white"),children:e.title}),e.snippet&&n.jsx("div",{className:"text-[11px] sm:text-sm leading-relaxed break-words mb-1 line-clamp-2 "+(t===k?"text-indigo-50 dark:text-gray-700":"text-gray-600 dark:text-gray-400"),children:e.snippet}),n.jsx("div",{className:"text-[8px] sm:text-[10px] font-mono truncate w-full opacity-80 "+(t===k?"text-white dark:text-indigo-700":"text-indigo-500 dark:text-indigo-200"),children:e.url})]})},t))})]})}export{i as S};
